SELECT c.custno, c.custname, CASE c.grade WHEN 'A' THEN 'VIP' WHEN 'B' THEN '일반' ELSE '직원' END AS grade, SUM(m.price) AS price FROM member_tbl_02 c JOIN money_tbl_02 m ON c.custno = m.custno and m.price is not null GROUP BY c.custno, c.custname, c.grade ORDER BY m.price desc;

select * from member_tbl_02;
drop table system.member_tbl_02
drop table money_tbl_02

create table member_tbl_02 (
    custno    number(6) primary key,
    custname  varchar2(20),
    phone     varchar2(13),
    address   varchar2(60),
    joindate  date,
    grade     char(1),
    city      char(2)
);

create table money_tbl_02(
custno number(6),
saleno1 number(8),
pcost number(8),
amount number(4),
price number(8),
pcode varchar2(4),
sdate date,
primary key(custno, saleno1)
);

insert into money_tbl_02 values (100001, 20160001, 500 , 5, 2500, 'A001', to_date('20160101','YYYYMMDD'));
insert into money_tbl_02 values (100001, 20160002, 1000, 4, 4000, 'A002', to_date('20160101','YYYYMMDD'));
insert into money_tbl_02 values (100001, 20160003, 500 , 3, 1500, 'A008', to_date('20160101','YYYYMMDD'));
insert into money_tbl_02 values (100002, 20160004, 200 , 1,  200, 'A004', to_date('20160102','YYYYMMDD'));
insert into money_tbl_02 values (100002, 20160005, 500 , 1,  500, 'A001', to_date('20160103','YYYYMMDD'));
insert into money_tbl_02 values (100003, 20160006, 1500, 2, 3000, 'A003', to_date('20160103','YYYYMMDD'));
insert into money_tbl_02 values (100004, 20160007, 500 , 2, 1000, 'A001', to_date('20160104','YYYYMMDD'));
insert into money_tbl_02 values (100004, 20160008, 300 , 1,  300, 'A005', to_date('20160104','YYYYMMDD'));
insert into money_tbl_02 values (100004, 20160009, 600 , 1,  600, 'A006', to_date('20160105','YYYYMMDD'));
insert into money_tbl_02 values (100004, 20160010, 3000, 1, 3000, 'A007', to_date('20160106','YYYYMMDD'));

desc member_tbl_02;
/* jdbc에선 안 먹네???*/

SELECT column_name, data_type, data_length, nullable
FROM user_tab_columns
WHERE table_name = 'MONEY_TBL_02';
/*AND owner = 'SCOTT'*/
/*이게 jdbc에서 desc쓰느 법*/